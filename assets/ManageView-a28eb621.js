import{_ as h,Z as B,o as m,Y as k,a0 as v,c as e,a2 as o,a4 as y,a5 as F,a7 as I,ap as c,aq as i,aa as d,ac as S,a9 as t,V as U,at as p,av as n,J as E,ag as A,ah as D,ai as T,aj as M}from"./index-80d7f52a.js";import{V as N}from"./VContainer-8ac70d2b.js";import{V as w}from"./VRow-da8767c0.js";import{V as f}from"./VCol-f52f2bcb.js";import{V as R}from"./VListItem-a6cca2a6.js";import{V}from"./VForm-4830ea7e.js";const j=u=>(A("data-v-46096baf"),u=u(),D(),u),q=j(()=>T("h1",{style:{"text-align":"center"}},"會員資料",-1)),J={__name:"ManageView",setup(u){const a=B(),_=F(),b=m(()=>`https://source.boringavatars.com/beam/120/${a.account}?colors=4EB3DE,8DE0A6,FCF09F,F27C7C,DE528C`),{apiAuth:P}=M(),r=k(),g=m(()=>a.password&&a.newPassword&&a.confirmPassword),x=async()=>{if(a.newPassword!==a.confirmPassword){r({text:"新密碼與確認密碼不一致",showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}});return}else if(a.newPassword.length<4){r({text:"新密碼長度不足",showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}});return}else if(a.password===a.newPassword){r({text:"新密碼與舊密碼相同",showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}});return}try{await P.patch("/users/password",{password:a.password,newPassword:a.newPassword}),r({text:"修改成功",showCloseButton:!1,snackbarProps:{timeout:2e3,color:"green",location:"bottom"}}),a.password="",a.newPassword="",a.confirmPassword="",a.logout(),_.push("/login")}catch{r({text:"修改失敗",showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}};return(C,l)=>(I(),v(y,null,[q,e(N,null,{default:o(()=>[e(w,null,{default:o(()=>[e(f,{cols:"12"},{default:o(()=>[e(c,null,{default:o(()=>[e(i,null,{default:o(()=>[d(S(t(a).account)+"會員您好",1)]),_:1}),e(R,null,{default:o(()=>[e(U,{src:b.value},null,8,["src"])]),_:1}),e(p,null,{default:o(()=>[e(V,null,{default:o(()=>[e(n,{modelValue:t(a).account,"onUpdate:modelValue":l[0]||(l[0]=s=>t(a).account=s),label:"帳號",readonly:""},null,8,["modelValue"]),e(n,{modelValue:t(a).email,"onUpdate:modelValue":l[1]||(l[1]=s=>t(a).email=s),label:"信箱",readonly:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(w,null,{default:o(()=>[e(f,{cols:"12"},{default:o(()=>[e(c,null,{default:o(()=>[e(i,null,{default:o(()=>[d("修改密碼(至少4個字元)")]),_:1}),e(p,null,{default:o(()=>[e(V,null,{default:o(()=>[e(n,{modelValue:t(a).password,"onUpdate:modelValue":l[2]||(l[2]=s=>t(a).password=s),label:"舊密碼",minlength:"4",maxlength:"20"},null,8,["modelValue"]),e(n,{modelValue:t(a).newPassword,"onUpdate:modelValue":l[3]||(l[3]=s=>t(a).newPassword=s),label:"新密碼",minlength:"4",maxlength:"20"},null,8,["modelValue"]),e(n,{modelValue:t(a).confirmPassword,"onUpdate:modelValue":l[4]||(l[4]=s=>t(a).confirmPassword=s),label:"確認新密碼"},null,8,["modelValue"]),e(E,{onClick:x,disabled:!g.value,color:"primary"},{default:o(()=>[d("修改密碼")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})],64))}},H=h(J,[["__scopeId","data-v-46096baf"]]);export{H as default};
