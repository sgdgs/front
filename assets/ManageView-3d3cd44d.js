import{_ as h,Z as B,o as m,Y as k,a0 as y,c as e,a2 as o,a4 as v,a5 as F,a7 as I,am as c,an as i,aa as d,ac as S,a9 as l,V as U,aq as p,as as n,J as E,ad as A,ae as D,af as T,ag as M}from"./index-444c6135.js";import{V as N}from"./VContainer-6e0b59c7.js";import{V as w}from"./VRow-1f1ccd93.js";import{V as f}from"./VCol-f899a641.js";import{V as R}from"./VListItem-ac12d9b7.js";import{V}from"./VForm-b53196c3.js";const q=u=>(A("data-v-46096baf"),u=u(),D(),u),J=q(()=>T("h1",{style:{"text-align":"center"}},"會員資料",-1)),L={__name:"ManageView",setup(u){const a=B(),_=F(),b=m(()=>`https://source.boringavatars.com/beam/120/${a.account}?colors=4EB3DE,8DE0A6,FCF09F,F27C7C,DE528C`),{apiAuth:P}=M(),r=k(),g=m(()=>a.password&&a.newPassword&&a.confirmPassword),x=async()=>{if(a.newPassword!==a.confirmPassword){r({text:"新密碼與確認密碼不一致",showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}});return}else if(a.newPassword.length<4){r({text:"新密碼長度不足",showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}});return}else if(a.password===a.newPassword){r({text:"新密碼與舊密碼相同",showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}});return}try{await P.patch("/users/password",{password:a.password,newPassword:a.newPassword}),r({text:"修改成功",showCloseButton:!1,snackbarProps:{timeout:2e3,color:"green",location:"bottom"}}),a.password="",a.newPassword="",a.confirmPassword="",a.logout(),_.push("/login")}catch{r({text:"修改失敗",showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}};return(C,s)=>(I(),y(v,null,[J,e(N,null,{default:o(()=>[e(w,null,{default:o(()=>[e(f,{cols:"12"},{default:o(()=>[e(c,null,{default:o(()=>[e(i,null,{default:o(()=>[d(S(l(a).account)+"會員您好",1)]),_:1}),e(R,null,{default:o(()=>[e(U,{src:b.value},null,8,["src"])]),_:1}),e(p,null,{default:o(()=>[e(V,null,{default:o(()=>[e(n,{modelValue:l(a).account,"onUpdate:modelValue":s[0]||(s[0]=t=>l(a).account=t),label:"帳號",readonly:""},null,8,["modelValue"]),e(n,{modelValue:l(a).email,"onUpdate:modelValue":s[1]||(s[1]=t=>l(a).email=t),label:"信箱",readonly:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(w,null,{default:o(()=>[e(f,{cols:"12"},{default:o(()=>[e(c,null,{default:o(()=>[e(i,null,{default:o(()=>[d("修改密碼(至少4個字元)")]),_:1}),e(p,null,{default:o(()=>[e(V,null,{default:o(()=>[e(n,{modelValue:l(a).password,"onUpdate:modelValue":s[2]||(s[2]=t=>l(a).password=t),label:"舊密碼",minlength:"4",maxlength:"20"},null,8,["modelValue"]),e(n,{modelValue:l(a).newPassword,"onUpdate:modelValue":s[3]||(s[3]=t=>l(a).newPassword=t),label:"新密碼",minlength:"4",maxlength:"20"},null,8,["modelValue"]),e(n,{modelValue:l(a).confirmPassword,"onUpdate:modelValue":s[4]||(s[4]=t=>l(a).confirmPassword=t),label:"確認新密碼"},null,8,["modelValue"]),e(E,{onClick:x,disabled:!g.value,color:"primary"},{default:o(()=>[d("修改密碼")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})],64))}},H=h(L,[["__scopeId","data-v-46096baf"]]);export{H as default};
