import{Y as x,Z as S,a1 as B,a2 as r,aj as k,a5 as C,a7 as y,c as e,a9 as a,au as F,av as m,J as M,aa as N,ai as U}from"./index-80d7f52a.js";import{c as q,a as i,u as P,d}from"./index.esm-1a07fb4a.js";import{V as R}from"./VContainer-8ac70d2b.js";import{V as p}from"./VCol-f52f2bcb.js";import{V as T}from"./VDivider-07b494a9.js";import{V as $}from"./VForm-4830ea7e.js";import{V as j}from"./VRow-da8767c0.js";const A=U("h1",null,"登入",-1),H={__name:"LoginView",setup(D){const{api:V}=k(),f=C(),c=x(),g=S(),b=q({account:i().required("帳號為必填欄位").min(4,"使用者帳號長度不符").max(20,"使用者帳號長度不符"),password:i().required("密碼為必填欄位").min(4,"密碼長度不符").max(20,"密碼長度不符")}),{handleSubmit:v,isSubmitting:w}=P({validationSchema:b}),l=d("account"),n=d("password"),h=v(async u=>{var o,t;try{const{data:s}=await V.post("/users/login",{account:u.account,password:u.password});g.login(s.result),console.log(s.result),c({text:"登入成功",showCloseButton:!1,snackbarProps:{timeout:2e3,color:"green",location:"bottom"}}),f.push("/")}catch(s){console.log(s);const _=((t=(o=s==null?void 0:s.response)==null?void 0:o.data)==null?void 0:t.message)||"發生錯誤，請稍後再試";c({text:_,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}});return(u,o)=>(y(),B(R,null,{default:r(()=>[e(j,null,{default:r(()=>[e(p,{cols:"12"},{default:r(()=>[A]),_:1}),e(T),e(p,{cols:"12"},{default:r(()=>[e($,{disabled:a(w),onSubmit:F(a(h),["prevent"])},{default:r(()=>[e(m,{label:"帳號",minlength:"4",maxlength:"20",counter:"",modelValue:a(l).value.value,"onUpdate:modelValue":o[0]||(o[0]=t=>a(l).value.value=t),"error-messages":a(l).errorMessage.value},null,8,["modelValue","error-messages"]),e(m,{label:"密碼",type:"password",minlength:"4",maxlength:"20",counter:"",modelValue:a(n).value.value,"onUpdate:modelValue":o[1]||(o[1]=t=>a(n).value.value=t),"error-messages":a(n).errorMessage.value},null,8,["modelValue","error-messages"]),e(M,{type:"submit",color:"green"},{default:r(()=>[N("登入")]),_:1})]),_:1},8,["disabled","onSubmit"])]),_:1})]),_:1})]),_:1}))}};export{H as default};
