import{_ as h,Z as k,o as m,Y as B,a0 as y,c as a,a3 as o,a5 as v,a6 as F,a8 as I,aq as c,ar as i,ab as d,ad as S,aa as l,V as U,au as p,aw as n,J as E,ae as A,af as D,a1 as T,ak as M}from"./index-b165e33f.js";import{V as N}from"./VContainer-ff0ca106.js";import{V as w}from"./VRow-e917330c.js";import{V as f}from"./VCol-030c10d2.js";import{V as R}from"./VListItem-d967e36e.js";import{V}from"./VForm-456cee08.js";const q=u=>(A("data-v-57e21354"),u=u(),D(),u),J=q(()=>T("h1",{style:{"text-align":"center"}},"會員資料",-1)),L={__name:"ManageView",setup(u){const e=k(),_=F(),b=m(()=>`https://source.boringavatars.com/beam/120/${e.account}?colors=4EB3DE,8DE0A6,FCF09F,F27C7C,DE528C`),{apiAuth:P}=M(),r=B(),g=m(()=>e.password&&e.newPassword&&e.confirmPassword),x=async()=>{if(e.newPassword!==e.confirmPassword){r({text:"新密碼與確認密碼不一致",showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}});return}else if(e.newPassword.length<4){r({text:"新密碼長度不足",showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}});return}else if(e.password===e.newPassword){r({text:"新密碼與舊密碼相同",showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}});return}try{await P.patch("/users/password",{password:e.password,newPassword:e.newPassword}),r({text:"修改成功",showCloseButton:!1,snackbarProps:{timeout:2e3,color:"green",location:"bottom"}}),e.password="",e.newPassword="",e.confirmPassword="",e.logout(),_.push("/login")}catch{r({text:"修改失敗",showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}};return(C,t)=>(I(),y(v,null,[J,a(N,null,{default:o(()=>[a(w,null,{default:o(()=>[a(f,{cols:"12"},{default:o(()=>[a(c,null,{default:o(()=>[a(i,null,{default:o(()=>[d(S(l(e).account)+"會員您好",1)]),_:1}),a(R,null,{default:o(()=>[a(U,{src:b.value},null,8,["src"])]),_:1}),a(p,null,{default:o(()=>[a(V,null,{default:o(()=>[a(n,{modelValue:l(e).account,"onUpdate:modelValue":t[0]||(t[0]=s=>l(e).account=s),label:"帳號",readonly:""},null,8,["modelValue"]),a(n,{modelValue:l(e).email,"onUpdate:modelValue":t[1]||(t[1]=s=>l(e).email=s),label:"信箱",readonly:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),a(w,null,{default:o(()=>[a(f,{cols:"12"},{default:o(()=>[a(c,null,{default:o(()=>[a(i,null,{default:o(()=>[d("修改密碼(至少4個字元)")]),_:1}),a(p,null,{default:o(()=>[a(V,null,{default:o(()=>[a(n,{modelValue:l(e).password,"onUpdate:modelValue":t[2]||(t[2]=s=>l(e).password=s),label:"舊密碼",minlength:"4",maxlength:"20"},null,8,["modelValue"]),a(n,{modelValue:l(e).newPassword,"onUpdate:modelValue":t[3]||(t[3]=s=>l(e).newPassword=s),label:"新密碼",minlength:"4",maxlength:"20"},null,8,["modelValue"]),a(n,{modelValue:l(e).confirmPassword,"onUpdate:modelValue":t[4]||(t[4]=s=>l(e).confirmPassword=s),label:"確認新密碼"},null,8,["modelValue"]),a(E,{onClick:x,disabled:!g.value,color:"primary"},{default:o(()=>[d("修改密碼")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})],64))}},H=h(L,[["__scopeId","data-v-57e21354"]]);export{H as default};
